apply plugin: 'org.xtext.xtend'
apply plugin: 'war'
apply plugin: 'org.akhikhl.gretty'
apply plugin: 'java-library'
apply plugin: 'eclipse'


def loadProperties = {
    def properties = new Properties()
    file('src/main/webapp/WEB-INF/explorviz.properties').withInputStream {
        properties.load(it)
    }
    return properties
}


buildscript {
  repositories {
      jcenter()
    }

    dependencies {
      classpath "org.xtext:xtext-gradle-plugin:1.0.19"
      classpath 'org.akhikhl.gretty:gretty:+'
    }
}


repositories {
  jcenter()
}

dependencies {
  // Any .jar in libs
  compile fileTree(dir: 'libs', include: '*.jar')
  // Xtend
  compile 'org.eclipse.xtend:org.eclipse.xtend.lib:2.9.0'
  compile 'org.eclipse.xtext:org.eclipse.xtext.xbase.lib:2.8.0'
  
  // Jersey and Servlet
  compile group: 'org.glassfish.jersey.containers', name: 'jersey-container-servlet', version:'2.26'
  compile group: 'javax.servlet', name: 'javax.servlet-api', version:'3.0.1'
  compile group: 'org.glassfish.jersey.inject', name: 'jersey-hk2', version:'2.26'
  
  
  // Database, ORM and Serialization
  compile group: 'com.h2database', name: 'h2', version:'1.4.196'
  compile group: 'de.ruedigermoeller', name: 'fst', version:'2.47'
  compile group: 'org.hibernate', name: 'hibernate-core', version:'5.2.11.Final'
  compile group: 'org.hibernate', name: 'hibernate-c3p0', version:'5.2.11.Final'
  
  // JSON + Parsing
  compile group: 'com.github.jasminb', name: 'jsonapi-converter', version:'0.8'
  compile group: 'org.glassfish.jersey.media', name: 'jersey-media-json-jackson', version:'2.23'
  compile group: 'com.fasterxml.jackson.core', name: 'jackson-core', version:'2.7.1'
  compile group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version:'2.7.1'
  compile group: 'com.fasterxml.jackson.core', name: 'jackson-annotations', version:'2.7.1'
  
  testImplementation 'junit:junit:4.12'
}


// Embedded Webserver
gretty {
	httpPort = loadProperties().httpPort.toInteger()
	servletContainer = loadProperties().servletContainer
	contextPath = loadProperties().contextPath
}