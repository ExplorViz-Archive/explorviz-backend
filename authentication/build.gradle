apply plugin: 'pmd'
apply plugin: 'checkstyle'
apply plugin: 'findbugs'

configurations {
	provided
	compile.extendsFrom(provided)
}


dependencies {
	compile project(':shared')
	
    testCompile 'junit:junit:4.12'
}


// Don't build war when tests fail
war.dependsOn check


// War plugin typically disables jar build
assemble.dependsOn jar

// Build .jar file with your "provided" dependencies only
jar {
  baseName = project.name 
  from configurations.provided.asFileTree.files.collect { zipTree(it) }
}


// Tooling
pmd {
	ignoreFailures = false
	// Clear the rule set first. Otherwise we would have a lot of additional rules in our rule set.
	ruleSets = []
	ruleSetFiles = files("conf/pmd.xml")
}

    
checkstyle {
	ignoreFailures = false
	showViolations = false
	configFile = file("conf/checkstyle.xml")
}

findbugs {
	reportLevel = "low"
	ignoreFailures = false
	effort = "max"
}

// Embedded Webserver
gretty {
  httpPort = 8082
  servletContainer = 'jetty9'
  contextPath = '/'
  recompileOnSourceChange = false
  reloadOnClassChange = false
  reloadOnConfigChange = false
  reloadOnLibChange = false
}
