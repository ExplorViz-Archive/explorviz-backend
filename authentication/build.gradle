apply plugin: 'pmd'
apply plugin: 'checkstyle'
apply plugin: 'findbugs'
apply plugin: 'com.github.johnrengelman.shadow'


buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.4'
    }
}

dependencies {
	implementation project(':shared')
}

assemble.dependsOn shadowJar

war {
	archiveName = "explorviz-${project.name}.${extension}"
}

jar {
  manifest {
    attributes(
      'Main-Class': 'net.explorviz.security.server.main.Main'
    )
  }
}

shadowJar {
	archiveName = "explorviz-${project.name}.${extension}"
}


// Tooling
pmd {
	// Clear the rule set first. Otherwise we would have a lot of additional rules in our rule set.
	ruleSets = []
	ruleSetFiles = files("../conf/pmd.xml")
	consoleOutput = false
	ignoreFailures = true
}

    
checkstyle {
	showViolations = false
	configFile = file("../conf/checkstyle.xml")
	ignoreFailures = true
}

findbugs {
	reportLevel = "low"
	effort = "max"
	ignoreFailures = true
}

// Embedded Webserver
gretty {
  httpPort = 8082
  servletContainer = 'jetty9'
  contextPath = '/'
  recompileOnSourceChange = false
  reloadOnClassChange = false
  reloadOnConfigChange = false
  reloadOnLibChange = false
}
